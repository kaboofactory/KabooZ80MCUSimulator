:root {
    --bg-dark: #1e1e1e;
    --bg-panel: #252526;
    --pcb-green: #005a00;
    --pcb-green-light: #007000;
    --pcb-trace: #004400;
    --text-silk: #e0c080;
    /* Gold silk screen */
    --led-off: #400000;
    --led-on: #ff0000;
    --seg-off: #333333;
    --seg-on: #ff0000;
}

body {
    margin: 0;
    padding: 0;
    font-family: 'Segoe UI', Consolas, monospace;
    background: var(--bg-dark);
    color: #ccc;
    height: 100vh;
    overflow: hidden;
}

.container {
    display: flex;
    height: 100%;
}

/* IDE Pane */
.ide-pane {
    width: 450px;
    display: flex;
    flex-direction: column;
    /* border-right: 4px solid #444; REMOVED for resizer */
    background: var(--bg-panel);
    flex-shrink: 0;
}

.ide-header {
    background: #333;
    padding: 10px;
    border-bottom: 1px solid #000;
}

.ide-header h1 {
    margin: 0 0 10px 0;
    font-size: 18px;
    color: #fff;
    text-transform: uppercase;
    letter-spacing: 2px;
}

.controls {
    display: flex;
    gap: 5px;
    flex-wrap: wrap;
    align-items: center;
}

button {
    background: #555;
    border: 1px solid #222;
    color: white;
    padding: 4px 10px;
    cursor: pointer;
    font-size: 12px;
}

button:hover {
    background: #666;
}

button:active {
    background: #444;
}

button.primary {
    background: #007acc;
    border-color: #005a9e;
}

button.primary:hover {
    background: #005a9e;
}

.sep {
    width: 1px;
    height: 20px;
    background: #666;
    margin: 0 5px;
}

.status-bar {
    margin-top: 5px;
    font-size: 12px;
    color: #88ff88;
}

.editor-wrapper {
    flex: 1;
    display: flex;
    position: relative;
    background: #1e1e1e;
    overflow: hidden;
}

.gutter {
    width: 40px;
    background: #2d2d30;
    color: #858585;
    text-align: right;
    padding: 5px 5px 20px 5px;
    font-size: 13px;
    line-height: 18px;
    border-right: 1px solid #444;
    user-select: none;
    overflow: hidden;
}

.gutter div {
    cursor: pointer;
}

.gutter .breakpoint {
    background: #a31515;
    color: #fff;
    font-weight: bold;
}

.gutter .highlight-line {
    background: #555;
    color: #fff;
    font-weight: bold;
}

.gutter .highlight-line.breakpoint {
    background: #007acc;
}

textarea {
    flex: 1;
    background: transparent;
    border: none;
    color: #dcdcdc;
    font-family: Consolas, monospace;
    font-size: 13px;
    line-height: 18px;
    padding: 5px;
    resize: none;
    outline: none;
    white-space: pre;
}

.debug-panel {
    /* height: 340px; Removed to allow collapsing */
    flex-shrink: 0;
    background: #222;
    border-top: 2px solid #444;
    padding: 10px;
    font-size: 13px;
    font-family: Consolas, monospace;
}

details summary {
    cursor: pointer;
    color: #888;
    outline: none;
    font-weight: bold;
    user-select: none;
    margin-bottom: 5px;
}

details[open] summary {
    color: #fff;
}

.debug-panel h3 {
    margin: 0 0 5px 0;
    font-size: 12px;
    color: #888;
}

.register-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 2px 5px;
    /* Compact gap */
}

.reg-item {
    color: #888;
    background: #1a1a1a;
    padding: 2px 5px;
    border: 1px solid #333;
    border-radius: 2px;
    font-size: 12px;
}

.reg-item.small {
    font-size: 11px;
}

.reg-item span {
    color: #ce9178;
    /* Code variable color */
    font-weight: bold;
    float: right;
}

.links {
    padding: 5px;
    text-align: right;
    font-size: 11px;
}

.links a {
    color: #569cd6;
    text-decoration: none;
}

/* PCB Pane */
.pcb-pane {
    flex: 1;
    background: #000;
    overflow: auto;
    padding: 20px;
    display: flex;
    justify-content: center;
}

.pcb-board {
    background-color: var(--pcb-green);
    /* PCB Trace Pattern Effect */
    background-image:
        linear-gradient(var(--pcb-trace) 1px, transparent 1px),
        linear-gradient(90deg, var(--pcb-trace) 1px, transparent 1px);
    background-size: 20px 20px;

    width: 800px;
    min-height: 800px;
    border-radius: 10px;
    box-shadow: inset 0 0 50px rgba(0, 0, 0, 0.6), 0 0 20px rgba(0, 0, 0, 0.5);
    padding: 30px;
    position: relative;
    color: var(--text-silk);
    font-family: 'Courier New', monospace;
    display: flex;
    flex-direction: column;
    gap: 20px;
}

.pcb-label-main {
    font-size: 24px;
    font-weight: bold;
    border: 2px solid var(--text-silk);
    padding: 5px 20px;
    align-self: flex-start;
    margin-bottom: 20px;
    background: rgba(0, 0, 0, 0.2);
}

.component-row {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 20px;
}

.component {
    background: rgba(0, 0, 0, 0.3);
    border: 1px solid rgba(255, 255, 255, 0.1);
    padding: 15px;
    border-radius: 4px;
    position: relative;
}

.comp-label {
    font-size: 11px;
    position: absolute;
    top: -8px;
    left: 10px;
    background: var(--pcb-green);
    padding: 0 4px;
    border: 1px solid var(--text-silk);
    color: var(--text-silk);
}

/* LEDs */
.led-array {
    display: flex;
    justify-content: center;
    gap: 15px;
}

.led {
    width: 20px;
    height: 20px;
    border-radius: 50%;
    background: var(--led-off);
    box-shadow: inset 2px 2px 5px rgba(0, 0, 0, 0.8);
    border: 2px solid #500;
}

.led.on {
    background: var(--led-on);
    box-shadow: 0 0 10px #f00, inset -2px -2px 5px rgba(255, 255, 255, 0.5);
    border-color: #800;
}

/* 7-Segment */
.seven-seg-wrapper {
    display: flex;
    justify-content: center;
    gap: 8px;
    background: #000;
    padding: 10px;
    border-radius: 4px;
    border: 1px solid #444;
}

.seven-seg-digit {
    width: 20px;
    height: 35px;
    position: relative;
    transform: skewX(-5deg);
}

.seg {
    position: absolute;
    background: var(--seg-off);
}

.seg.on {
    background: var(--seg-on);
    box-shadow: 0 0 4px #f00;
}

.s-a {
    top: 0;
    left: 2px;
    right: 2px;
    height: 3px;
}

.s-b {
    top: 2px;
    right: 0;
    width: 3px;
    height: 14px;
}

.s-c {
    bottom: 2px;
    right: 0;
    width: 3px;
    height: 14px;
}

.s-d {
    bottom: 0;
    left: 2px;
    right: 2px;
    height: 3px;
}

.s-e {
    bottom: 2px;
    left: 0;
    width: 3px;
    height: 14px;
}

.s-f {
    top: 2px;
    left: 0;
    width: 3px;
    height: 14px;
}

.s-g {
    top: 16px;
    left: 2px;
    right: 2px;
    height: 3px;
}

.s-dp {
    bottom: -2px;
    right: -4px;
    width: 3px;
    height: 3px;
    border-radius: 50%;
}

/* LCD */
.lcd-screen {
    background: #8fa;
    width: 80%;
    margin: 0 auto;
    height: 80px;
    border: 4px solid #444;
    border-radius: 4px;
    font-family: 'Courier New', monospace;
    color: #111;
    padding: 5px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    box-shadow: inset 2px 2px 5px rgba(0, 0, 0, 0.3);
}

.lcd-line {
    height: 32px;
    line-height: 32px;
    font-size: 24px;
    font-weight: bold;
    white-space: pre;
    overflow: hidden;
    letter-spacing: 2px;
}

/* Piezo */
.piezo-hole {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: #111;
    margin: 0 auto;
    border: 2px solid #888;
    position: relative;
}

.piezo-hole::after {
    content: '';
    position: absolute;
    top: 12px;
    left: 12px;
    width: 16px;
    height: 16px;
    background: #d4af37;
    border-radius: 50%;
}

/* Matrix */
.matrix-grid {
    display: grid;
    grid-template-columns: repeat(16, 1fr);
    gap: 2px;
    background: #000;
    padding: 5px;
    width: max-content;
    margin: 0 auto;
    border: 1px solid #444;
}

.m-dot {
    width: 6px;
    height: 6px;
    background: #300;
    border-radius: 50%;
}

.m-dot.on {
    background: #f00;
    box-shadow: 0 0 3px #f00;
}

/* Keypad */
.keypad-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 5px;
    width: 140px;
    margin: 0 auto;
}

.key {
    background: #333;
    border: 1px solid #111;
    color: #fff;
    height: 30px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 14px;
    cursor: pointer;
    box-shadow: 1px 1px 3px #000;
    user-select: none;
}

.key:active {
    background: #555;
    transform: translate(1px, 1px);
    box-shadow: none;
}

/* DIP Switches */
.dip-container {
    display: flex;
    justify-content: center;
    gap: 15px;
    background: #d00;
    /* DIP package color */
    padding: 10px 20px;
    border-radius: 2px;
    box-shadow: 2px 2px 5px #000;
    width: fit-content;
    margin: 0 auto;
}

.dip-switch {
    display: flex;
    flex-direction: column;
    align-items: center;
    cursor: pointer;
}

.dip-slider {
    width: 10px;
    height: 20px;
    background: #fff;
    border: 1px solid #aaa;
    position: relative;
}

.dip-knob {
    width: 100%;
    height: 50%;
    background: #333;
    position: absolute;
    top: 50%;
    /* OFF position default */
    transition: top 0.1s;
}

.dip-switch.on .dip-knob {
    top: 0;
}

.dip-label {
    color: #fff;
    font-size: 10px;
    margin-top: 2px;
}

/* Interrupt Buttons */
.btn-container {
    display: flex;
    justify-content: center;
    gap: 10px;
}

.push-btn {
    width: 30px;
    height: 30px;
    border-radius: 50%;
    background: #444;
    border: 2px solid #222;
    cursor: pointer;
    box-shadow: 2px 2px 4px #000;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 10px;
    color: #aaa;
}

.push-btn:active {
    background: #666;
    transform: translate(1px, 1px);
    box-shadow: none;
}

#speed-val {
    display: inline-block;
    width: 60px;
    text-align: right;
    font-family: monospace;
}

/* Resizer Splitter */
.resizer {
    width: 6px;
    background: #444;
    cursor: col-resize;
    flex-shrink: 0;
    transition: background 0.2s;
    z-index: 100;
}

.resizer:hover,
.resizer.resizing {
    background: #007acc;
}

/* Decorative Components */
:root {
    --deco-pad-silver: #c0c0c0;
    --deco-trace-light: #007000;
    /* Lighter trace for realism */
}

/* Aligned Board Layout */
.deco-board-aligned {
    display: flex;
    align-items: flex-start;
    gap: 20px;
    margin-top: 10px;
    padding: 10px;
    border: 1px solid var(--pcb-trace);
    background:
        linear-gradient(var(--pcb-trace) 1px, transparent 1px),
        linear-gradient(90deg, var(--pcb-trace) 1px, transparent 1px);
    background-size: 20px 20px;
    position: relative;
}

.deco-board-aligned::before {
    content: '';
    position: absolute;
    inset: 0;
    background-color: rgba(0, 50, 0, 0.3);
    pointer-events: none;
    z-index: 0;
}

.deco-block {
    display: flex;
    flex-direction: column;
    align-items: center;
    position: relative;
    z-index: 1;
}

.deco-block-v {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    position: relative;
    z-index: 1;
}

.comp-label-small {
    color: #aaa;
    font-size: 9px;
    margin-bottom: 4px;
    font-family: monospace;
}

.deco-array-h {
    display: flex;
    gap: 4px;
    /* Dense packing */
    align-items: center;
}

/* Wrappers for Pads + Component */
.deco-cap-wrapper,
.deco-res-wrapper {
    display: flex;
    flex-direction: column;
    align-items: center;
    position: relative;
}

.deco-res-wrapper.v-mount {
    height: 40px;
    justify-content: space-between;
}

.deco-res-wrapper.v-mount .deco-resistor {
    /* Vertical resistor is rotated, so we need to adjust layout or just not rotate and style upright */
    /* Let's style an upright resistor specifically for this density */
    transform: none;
    width: 10px;
    height: 26px;
    background: #eec591;
    border-radius: 2px;
}

.deco-res-wrapper.v-mount .deco-resistor::before {
    /* Lead line vertical */
    content: '';
    position: absolute;
    top: -5px;
    bottom: -5px;
    left: 50%;
    width: 1px;
    background: radial-gradient(#222 20%, silver 40%);
    border-radius: 50%;
    margin: 2px 0;
}


/* --- Components --- */

/* ICs */
.deco-ic {
    background: #0b0b0b;
    border: 1px solid #222;
    color: #bbb;
    font-size: 9px;
    font-family: Arial, sans-serif;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.6);
    position: relative;
    z-index: 2;
    border-radius: 1px;
}

.deco-ic.large {
    width: 110px;
    height: 28px;
}

.deco-ic.medium {
    width: 60px;
    height: 20px;
}

.deco-ic.small {
    width: 30px;
    height: 20px;
}

/* IC Pins (Metallic) */
.deco-ic::before,
.deco-ic::after {
    content: '';
    position: absolute;
    left: 4px;
    right: 4px;
    height: 4px;
    background: repeating-linear-gradient(90deg,
            #d0d0d0 0, #d0d0d0 2px,
            /* Pin */
            transparent 2px, transparent 8px
            /* Gap */
        );
    z-index: -1;
}

.deco-ic::before {
    top: -4px;
}

.deco-ic::after {
    bottom: -4px;
}

/* IC Notch */
.deco-ic::after {
    /* Shift purpose - Reusing after for pins, let's use a child div or pseudo if careful */
}

.deco-chip-notch {
    /* Or just use a dot text */
}


/* Resistors */
.deco-resistor {
    width: 32px;
    height: 10px;
    background: #eec591;
    /* Beige body */
    border-radius: 3px;
    position: relative;
    z-index: 2;
    box-shadow: 1px 1px 2px rgba(0, 0, 0, 0.4);
}

.deco-resistor.v-mount {
    transform: rotate(90deg);
}

/* Leads */
.deco-resistor::before {
    content: '';
    position: absolute;
    top: 50%;
    left: -8px;
    right: -8px;
    height: 1px;
    background: #ccc;
    z-index: -1;
}

/* Bands */
/* Bands - Default 1kΩ (Brown-Black-Red-Gold) */
.deco-resistor::after {
    content: '';
    position: absolute;
    top: 0;
    bottom: 0;
    left: 6px;
    right: 6px;
    background: linear-gradient(90deg,
            #8b4513 0%, #8b4513 25%,
            /* Brown */
            black 25%, black 50%,
            /* Black */
            red 50%, red 75%,
            /* Red */
            gold 75%, gold 100%
            /* Gold */
        );
    opacity: 0.9;
}

/* V-mount override for vertical bands (top-to-bottom) */
.deco-res-wrapper.v-mount .deco-resistor::after {
    left: 0;
    right: 0;
    top: 0;
    bottom: 0;
    /* 1kΩ: Brown-Black-Red-Gold */
    background: linear-gradient(to bottom,
            transparent 2px,
            #8b4513 2px, #8b4513 5px,
            /* Brown */
            transparent 5px, transparent 8px,
            black 8px, black 11px,
            /* Black */
            transparent 11px, transparent 14px,
            red 14px, red 17px,
            /* Red */
            transparent 17px, transparent 20px,
            gold 20px, gold 23px,
            /* Gold */
            transparent 23px);
}

/* Alternate Resistor Style - 680Ω (Blue-Gray-Brown-Gold) - High Specificity */
.deco-res-wrapper.v-mount .deco-resistor.alt::after {
    background: linear-gradient(to bottom,
            transparent 2px,
            blue 2px, blue 5px,
            /* Blue */
            transparent 5px, transparent 8px,
            gray 8px, gray 11px,
            /* Gray */
            transparent 11px, transparent 14px,
            #8b4513 14px, #8b4513 17px,
            /* Brown */
            transparent 17px, transparent 20px,
            gold 20px, gold 23px,
            /* Gold */
            transparent 23px);
}


/* Ceramic Capacitor (Orange Disc) */
.deco-cap {
    width: 14px;
    height: 14px;
    background: #d35400;
    border-radius: 50%;
    position: relative;
    z-index: 2;
    box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5);
}

/* Electrolytic Capacitor */
.deco-elec {
    width: 16px;
    height: 16px;
    background: radial-gradient(circle at 30% 30%, #444, #111);
    border-radius: 50%;
    /* Top view */
    border: 1px solid #888;
    /* Silver top lip */
    position: relative;
    z-index: 2;
    box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.6);
}

.deco-elec::after {
    /* Vent stamp */
    content: '+';
    color: #666;
    font-size: 10px;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
}